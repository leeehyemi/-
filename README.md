# 적외선 카메라를 사용한 수면 패턴 분석 및 케어 서비스
학부 졸업논문으로 구현한 프로젝트입니다.</br>
- 적외선 카메라를 통해 불면증을 가지고 있는 사람들을 위해 불면증을 치유하기 위한 목적을 가진다. 
- 라즈베리파이와 연결하여 적외선 카메라 MLX90640로 촬영
- 딥러닝 CNN 기술과 접목시켜 수면 패턴 분석, 수면케어 시스템 설계

## 적외선 카메라 MLX90640 
- AMG8833에 비해 비교적 높은 해상도와 넓은 온도 측정 범위를 가지고 있는 MLX90640을 선택하여 프로젝트를 진행</br>
![카메라 비교](https://github.com/user-attachments/assets/71914634-6933-4bf9-a766-e8fa5c9bfc57)
## 비접촉식 수면 상태 분석과 판정
 - 적외선카메라 MLX90640을 연결한 라즈베리파이에서 촬영한 영상을 바탕으로 </br>
 수면 중 사용자의 체온과 "정면", "왼쪽", "오른쪽"의 3가지 자세 중 어떤자세로 수면을 취하는지 판정
 - 사용자 접촉식 장치를 부착하지 않아도 수면 정보를 얻고 수면 상태를 판정할 수 있다.</br>
 - 타제품과 차이
 ![차이점](https://github.com/user-attachments/assets/a4cebb5b-7827-428d-a437-62d8dd9bbb91)
   
## 수면 자세 인식
- TensorFlow와 Keras를 활용하여 수면 자세 분류 모델 개발
- 카메라로 촬영된 사용자의 수면 자세를 딥러닝 Convolutional neural network(CNN) 기술로 분류하여</br>
사용자가 "정면", "왼쪽", "오른쪽"의 3가지 자세 중 어떤 자세로 수면을 취하는지 구분
- 약 3000장의 (120,160) 사이즈 데이터셋을 (224,224)로 리사이즈, 3가지 자세의 SLP 수면 전신 이미지 데이터셋으로 훈련</br>
![데이터셋](https://github.com/user-attachments/assets/10a797dd-693f-466c-83a4-6560cc810bcc)

- 적외선 카메라로 촬영한 (24x32) 이미지를 추론하기 위해 데이터 증식을 적용하여 저해상도의 이미지에서도 정확한 추론을 하도록 한다.
- 데이터셋 7536장 중 80% 훈련 데이터, 20% 테스트 데이터로 분할, 훈련 데이터의 20%를 검증 데이터로 활용
- 데이터 증식을 적용한 모델과 적용하지 않은 모델의 훈련 정확도는 각각 99.54%, 97.51로 근소한 차이를 보였지만</br>
검증 정확도가 98.09%, 81.01%로 큰 차이를 보였다.</br>
#### 데이터 증식 전 정확도
![증식후 훈련정확도, 검증정확도](https://github.com/user-attachments/assets/4c8ccd2f-d301-402a-848c-a1ec419315e6)

#### 데이터 증식 후 정확도
![증식전 훈련 정확도, 검증정확도](https://github.com/user-attachments/assets/871c1391-b98b-462b-9a54-34420bc5d84a)

## RaspberryPi IoT
- 라즈베리파이에 적외선 카메라 MLX90640을 연결하여 사용자의 수면 자세와 체온을 측정</br>
![실제 촬영](https://github.com/user-attachments/assets/c6b035f4-ec67-4b19-a5c1-2c31fcadbfb1)
- LED 센서를 활용하여 조명을 제어
- 측정된 체온이 37도 이상일 경우 DC 모터로 에어컨 기능을 구현하여 사용자의 체온을 안정시킨다.
-  pygame mixer 라이브러리를 통해서 음악 재생을하여 편안한 수면 유도  
 
